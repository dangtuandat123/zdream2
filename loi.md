Reviewed the image generation path (Livewire ImageGenerator → GenerateImageJob → OpenRouterService → adapters) and checked request/response handling against OpenRouter’s image-generation docs.

Findings

[High] Missing server‑side validation that openrouter_model_id is actually image‑capable lets text‑only or stale models be saved and used, which then fail when modalities: ["image","text"] are sent. StyleController.php (line 80) StyleController.php (line 194). Repro: edit/create a style and set a non‑image model id (or removed id), then generate. Expected: validation error before save/use. Actual: request hits OpenRouter and fails. Fix: validate against ModelManager::fetchModels() ids (only models with output_modalities containing "image"), and/or block in OpenRouterService::generateImage before dispatch. OpenRouter explicitly requires image‑capable models (output_modalities includes "image") and modalities: ["image","text"] for image generation. (openrouter.ai)
[Medium] Model discovery falls back to substring patterns when output_modalities is missing, which can surface non‑image models in the admin picker. OpenRouterService.php (line 173) OpenRouterService.php (line 205). Repro: if /models returns entries without output_modalities, pattern matches (e.g., “flash”) will mark them as image models. Expected: only models with output_modalities containing "image" appear. Actual: false positives can be listed and selected. Fix: require output_modalities (or architecture.output_modalities) to include "image"; if missing, mark as unknown and hide unless explicitly allow‑listed. This aligns with OpenRouter’s guidance to use only models whose output_modalities include "image". (openrouter.ai)
[Medium] GeminiAdapter::supports treats any Gemini model containing “flash” as image‑capable, which can force image_config and image modalities on text‑only Gemini Flash models. GeminiAdapter.php (line 14) GeminiAdapter.php (line 18). Repro: set a Gemini Flash text model id; generation uses Gemini adapter and sends image_config. Expected: adapter should only apply to Gemini image models. Actual: text‑only Gemini Flash models are treated as image gen. Fix: require “image” in model id or pass model metadata into adapter selection; only use image_config for Gemini image‑generation models. (openrouter.ai)
[Medium] No cap on total images or total payload size when combining user uploads + system images, even though OpenRouter notes image limits vary by model. OpenRouterService.php (line 395) BaseAdapter.php (line 188) StyleController.php (line 88). Repro: define many slots (up to 10) + system images (up to 5), upload all. Expected: validation blocks or trims to model limits. Actual: all images are sent; request can fail with 400/413 or provider limits. Fix: define per‑model max images/bytes and enforce in validation or before dispatch; surface a user‑friendly error. OpenRouter notes image count limits vary by provider/model and recommends placing text first then images. (openrouter.ai)
[Low] If a provider returns raw base64 without a data‑URL prefix, BaseAdapter::normalizeImageValue always prefixes as PNG, which can mislabel JPEG/WebP outputs. BaseAdapter.php (line 51) BaseAdapter.php (line 65). Expected: mime matches actual data. Actual: forced image/png. Fix: detect mime from decoded bytes or require data‑URL responses. OpenRouter’s image responses are typically base64 data URLs (PNG), but not guaranteed for all models. (openrouter.ai)
Spec alignment (checked)

Requests use /api/v1/chat/completions with modalities: ["image","text"], which matches OpenRouter’s image generation guidance. (openrouter.ai)
Input images are attached as messages[].content parts with image_url/base64, and text-first ordering is compatible with OpenRouter’s image input recommendations. (openrouter.ai)
Gemini image_config supports aspect_ratio and image_size (1K/2K/4K) and your adapter sets those when Gemini is selected. (openrouter.ai)
Response parsing targets message.images with base64 data URLs, which matches OpenRouter’s response format. (openrouter.ai)
Open questions / assumptions

Do you want to hard‑block any model not returned by /models with "image" in output_modalities, or allow manual overrides for BYOK/preview models?
Do you have per‑model limits for number/size of input images? If not, I can add a conservative global limit and per‑model override map.